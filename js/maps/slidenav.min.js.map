{"version":3,"sources":["slidenav.js"],"names":["$","Drupal","behaviors","clarin_theme_slidenav","attach","context","handlersAttached","headerHeight","lastScrollPosition","body","header","collapsingNavbar","adminBar","handleClickOut","event","contains","target","css","collapse","handleScroll","parseFloat","window","getComputedStyle","height","pageScrollPosition","pageYOffset","document","documentElement","scrollTop","adminBarHeight","style","paddingTop","fixedAdminBarHeight","classList","defaultStickyTop","observedStickyTop","top","relativeDelta","add","remove","setHandlers","attached","getElementById","setTimeout","addEventListener","removeEventListener","on","jQuery"],"mappings":"CAAA,SAAUA,EAAGC,GAMXA,EAAOC,UAAUC,sBAAwB,CACvCC,OAAQ,SAAgBC,GACtB,IAAIC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EAEJ,SAASC,EAAeC,GAEnBJ,EAAOK,SAASD,EAAME,SACV,MAAZJ,GAA2BA,EAASG,SAASD,EAAME,SAChB,SAApCL,EAAiBM,IAAI,YAKrBN,EAAiBO,SAAS,QAI9B,SAASC,IACPZ,EAAea,WAAWC,OAAOC,iBAAiBZ,GAAQa,QAC1D,MAAMC,EACJH,OAAOI,aAAeC,SAASC,gBAAgBC,UAC3CC,EAAiBT,WAAWX,EAAKqB,MAAMC,aAAe,EACtDC,EACJvB,EAAKqB,MAAMC,YAActB,EAAKwB,UAAUlB,SAAS,iBAC7Cc,EACA,EACAK,EAAmBF,EAAsBzB,EACzC4B,EAAoBzB,EAAOoB,MAAMM,IACnChB,WAAWV,EAAOoB,MAAMM,KACxB,EACEC,EACJ7B,EAAqBgB,EAAqBW,EAG1CE,EAAgBH,GAChBG,EAAgBL,GAGhBtB,EAAOoB,MAAMM,IAASC,EAAH,KAGjBb,GACyB,IAAxBQ,EACGzB,EAAesB,EACftB,IAEJG,EAAOuB,UAAUK,IAAI,kBAEdD,EAAgBH,GAEzBxB,EAAOoB,MAAMM,IAASF,EAAH,KACnBxB,EAAOuB,UAAUM,OAAO,kBACfF,EAAgBL,IAEzBtB,EAAOoB,MAAMM,IAASJ,EAAH,KAGjBR,IACyB,IAAxBQ,EAA4BH,EAAiB,IAE9CnB,EAAOuB,UAAUM,OAAO,kBAG5B/B,EAAqBgB,EAGvB,SAASgB,EAAYC,GAWnB,OAVAhC,EAAOiB,SAASjB,KAChBG,EAAWc,SAASgB,eAAe,0BACnChC,EAASgB,SAASgB,eAAe,UACjC/B,EAAmBX,EAAE,oBAAqBS,GAC1CD,EACEa,OAAOI,aAAeC,SAASC,gBAAgBC,UACjDP,OAAOsB,WAAW,KAChBpC,EAAea,WAAWC,OAAOC,iBAAiBZ,GAAQa,UAGnB,aAArCZ,EAAiBM,IAAI,aAElBwB,IAEHhC,EAAKmC,iBAAiB,QAAS/B,GAAgB,GAC/CQ,OAAOuB,iBAAiB,SAAUzB,GAAc,KAG3C,IAGLsB,IAEFhC,EAAKoC,oBAAoB,QAAShC,GAAgB,GAClDQ,OAAOwB,oBAAoB,SAAU1B,GAAc,KAG9C,GAGLd,IAAYqB,WACdpB,EAAmBkC,IAGnBxC,EAAEqB,OAAQhB,GAASyC,GAAG,UAAU,WAC9BxC,EAAmBkC,EAAYlC,SAlHzC,CAuHGyC,OAAQ9C","file":"../slidenav.min.js","sourcesContent":["(function($, Drupal) {\n  // CLARIN slidenav helper methods for the top navbar menu. The slidenav is only used on screens narrower\n  // than 1200px and when activated in the theme options.\n  // - When the window width is narrower than 1200px, add a click handler to dismiss (slide out) the mobile floating\n  //     menu when clicking outside of it.\n  // - Remove the handler if the window becomes wider.\n  Drupal.behaviors.clarin_theme_slidenav = {\n    attach: function attach(context) {\n      let handlersAttached;\n      let headerHeight;\n      let lastScrollPosition;\n      let body;\n      let header;\n      let collapsingNavbar;\n      let adminBar;\n\n      function handleClickOut(event) {\n        if (\n          !header.contains(event.target) && // do not close menu if clicking on it\n          (adminBar == null ? true : !adminBar.contains(event.target)) && // do not close menu if clicking on adminBar\n          collapsingNavbar.css(\"display\") !== \"none\"\n        ) {\n          // is closed\n\n          // collapse navbar\n          collapsingNavbar.collapse(\"hide\");\n        }\n      }\n\n      function handleScroll() {\n        headerHeight = parseFloat(window.getComputedStyle(header).height);\n        const pageScrollPosition =\n          window.pageYOffset || document.documentElement.scrollTop;\n        const adminBarHeight = parseFloat(body.style.paddingTop) || 0;\n        const fixedAdminBarHeight =\n          body.style.paddingTop && body.classList.contains(\"toolbar-fixed\")\n            ? adminBarHeight\n            : 0;\n        const defaultStickyTop = fixedAdminBarHeight - headerHeight;\n        const observedStickyTop = header.style.top\n          ? parseFloat(header.style.top)\n          : 0;\n        const relativeDelta =\n          lastScrollPosition - pageScrollPosition + observedStickyTop;\n\n        if (\n          relativeDelta > defaultStickyTop &&\n          relativeDelta < fixedAdminBarHeight\n        ) {\n          // in betwen stage\n          header.style.top = `${relativeDelta}px`;\n\n          if (\n            pageScrollPosition >\n            (fixedAdminBarHeight === 0\n              ? headerHeight + adminBarHeight\n              : headerHeight)\n          ) {\n            header.classList.add(\"shadow-header\");\n          }\n        } else if (relativeDelta < defaultStickyTop) {\n          // fully disappears\n          header.style.top = `${defaultStickyTop}px`;\n          header.classList.remove(\"shadow-header\");\n        } else if (relativeDelta > fixedAdminBarHeight) {\n          // fully appears\n          header.style.top = `${fixedAdminBarHeight}px`;\n\n          if (\n            pageScrollPosition <=\n            (fixedAdminBarHeight === 0 ? adminBarHeight : 0)\n          ) {\n            header.classList.remove(\"shadow-header\");\n          }\n        }\n        lastScrollPosition = pageScrollPosition;\n      }\n\n      function setHandlers(attached) {\n        body = document.body;\n        adminBar = document.getElementById(\"toolbar-administration\");\n        header = document.getElementById(\"header\");\n        collapsingNavbar = $(\"#CollapsingNavbar\", body);\n        lastScrollPosition =\n          window.pageYOffset || document.documentElement.scrollTop;\n        window.setTimeout(() => {\n          headerHeight = parseFloat(window.getComputedStyle(header).height); /// Track page scroll with extra XYpx \"delay\"\n        });\n\n        if (collapsingNavbar.css(\"position\") === \"absolute\") {\n          // When the viewport is narrow enough #collapsingNavbar becomes \"fixed\" -> attach handler to body\n          if (!attached) {\n            // Add listeners\n            body.addEventListener(\"click\", handleClickOut, true);\n            window.addEventListener(\"scroll\", handleScroll, true);\n            // console.log(\"handlers attached\");\n          }\n          return true;\n        }\n        // When the viewport is wide enough  -> detach handler from body\n        if (attached) {\n          // Remove listeners\n          body.removeEventListener(\"click\", handleClickOut, true);\n          window.removeEventListener(\"scroll\", handleScroll, true);\n          // console.log(\"handlers dettached\");\n        }\n        return false;\n      }\n\n      if (context === document) {\n        handlersAttached = setHandlers();\n\n        // On resize event set click handler to dismiss the mobile floating menu\n        $(window, context).on(\"resize\", function handleResize() {\n          handlersAttached = setHandlers(handlersAttached);\n        });\n      }\n    }\n  };\n})(jQuery, Drupal);\n"]}